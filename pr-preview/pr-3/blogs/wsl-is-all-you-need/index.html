<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>WSL is All You Need | ÁßãÊ∞¥¬∑JamesNULLiu</title><meta name=keywords content="wsl,programming,game"><meta name=description content="How do I work with WSL"><meta name=author content="jamesnulliu"><link rel=canonical href=https://jamesnulliu.github.io/blogs/wsl-is-all-you-need/><link crossorigin=anonymous href=/assets/css/stylesheet.62cb9c488bb33c0e9a9d3c29b7f4259cbb0db25aaa19ba672188203d3d5bcaf9.css integrity="sha256-YsucSIuzPA6anTwpt/QlnLsNslqqGbpnIYggPT1byvk=" rel="preload stylesheet" as=style><link rel=icon href=https://jamesnulliu.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jamesnulliu.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jamesnulliu.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jamesnulliu.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jamesnulliu.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://jamesnulliu.github.io/blogs/wsl-is-all-you-need/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]]}}</script><meta property="og:url" content="https://jamesnulliu.github.io/blogs/wsl-is-all-you-need/"><meta property="og:site_name" content="ÁßãÊ∞¥¬∑JamesNULLiu"><meta property="og:title" content="WSL is All You Need"><meta property="og:description" content="How do I work with WSL"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2025-01-10T13:25:00+08:00"><meta property="article:modified_time" content="2025-09-12T21:45:48+00:00"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Wsl"><meta property="article:tag" content="Environment"><meta name=twitter:card content="summary"><meta name=twitter:title content="WSL is All You Need"><meta name=twitter:description content="How do I work with WSL"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://jamesnulliu.github.io/blogs/"},{"@type":"ListItem","position":2,"name":"WSL is All You Need","item":"https://jamesnulliu.github.io/blogs/wsl-is-all-you-need/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"WSL is All You Need","name":"WSL is All You Need","description":"How do I work with WSL","keywords":["wsl","programming","game"],"articleBody":"1. Motivation Coding on Windows feels like a nightmare, but most games do not run on Linux, and I hate MacOS ü§¢ü§Æ from many aspects.\nAfter trying many ways, now I firmly believe that WSL (as a Docker launcher ü§£) is the best solution if:\nYou are a programmer specifically relying on Unix environment, for example, Deep Learning, CUDA, C++, etc. You are a gamer who wants to play games on Windows. You want to switch between Linux and Windows with zero cost. üí°NOTE\nWindows Subsystem for Linux (WSL) is a feature of Windows that allows you to run a Linux environment on your Windows machine, without the need for a separate virtual machine or dual booting. WSL is designed to provide a seamless and productive experience for developers who want to use both Windows and Linux at the same time.\n2. Installation Official Doc: How to install Linux on Windows with WSL ‚ö†Ô∏èWARNING\nIf you are using scoop on Windows, make sure uninstall it before the first-time installation of a WSL distribution. You can reinstall scoop after the installation.\nList all available WSL distributions:\n1 wsl --list --online Install a specific WSL distribution:\n1 wsl --install -d \u003cdistro-name\u003e Run a WSL distribution:\n1 wsl -d \u003cdistro-name\u003e 3. Change the Storage Location of a Distribution List installed WSL distributions:\n1 wsl -l -v Shutdown WSL service:\n1 wsl --shutdown Export a WSL distribution:\n1 wsl --export \u003cdistro-name\u003e \u003cpath-to-exported-tar\u003e.tar Unregister the target WSL distribution:\n1 wslconfig /u \u003cdistro-name\u003e Import a WSL distribution from tar and specify the storage location; Note that you can specify any new distro name here:\n1 wsl --import \u003cnew-distro-name\u003e \u003cpath-to-the-new-storage-dir\u003e \u003cpath-to-exported-tar\u003e.tar After importing, the default user of would become root. You can set the default user for a WSL distribution by modifying the /etc/wsl.conf file. See 7. Default User .\n4. Work with VSCode Run a WSL distribution:\n1 wsl -d \u003cdistro-name\u003e Open a directory in WSL with VSCode:\n1 code \u003cpath-to-a-directory-in-wsl\u003e 5. Install Docker in WSL I don‚Äôt like Docker Desktop for Windows. Instead, you can install Docker in WSL as you do in a normal Linux system.\nIf you want to play with cuda and deep learning in your WSL, see this blog: Docker Container with Nvidia GPU Support If you need a concise mannual for docker images and containers, see this blog: Something about Docker To open a directory inside a running container with VSCode, install extension ms-vscode-remote.remote-containers, and:\nOpen a directory in a WSL (where you installed docker and ran containers) with VSCode following 4. Work with VSCode . Press ctrl + shift + p, search for command ‚ÄúDev Containers: Attach to Running Container‚Ä¶‚Äù. Choose and click the container you want to open. That‚Äôs it. 6. Proxy Somethimes you may need to set the proxy for your subsystem.\nFrom my experience, the easiest way is to turn on System Proxy and TUN Mode in clash or v2ray on windows, and your WSL and the running containers will automatically use the proxy.\n7. Default User You can set the default user for a WSL distribution by modifying the /etc/wsl.conf file.\nFirst, login to a WSL distribution:\n1 wsl -d \u003cdistro-name\u003e Then, create or modify the /etc/wsl.conf file:\n1 sudo vim /etc/wsl.conf Add the following lines to the file:\n1 2 [user] default= 8. Hostname You can set the hostname for a WSL distribution by modifying the /etc/hostname file.\nFirst, login to a WSL distribution:\n1 wsl -d \u003cdistro-name\u003e Then, create or modify the /etc/wsl.conf file:\nsudo vim /etc/wsl.conf Add the following lines to the file:\n[network] hostname = 9. Compress the WSL File System Virtual disk files will grow automatically as you add files, but they will not shrink automatically when you delete files. This can lead to a large virtual disk file that takes up a lot of space on your hard drive.\nFirst, search for a .vdhx file in your computer, which is the virtual disk file for your WSL distribution. The default location is ‚ÄúC:/Users//AppData/Local/wsl//ext4.vhdx‚Äù.\nThen, run the following command in PowerShell:\n1 wsl --shutdown After that, run diskpart:\n1 diskpart In the pop-up window, run the following commands:\n1 2 3 select vdisk file=\"\" compact vdisk detach vdisk ","wordCount":"700","inLanguage":"en","datePublished":"2025-01-10T13:25:00+08:00","dateModified":"2025-09-12T21:45:48Z","author":[{"@type":"Person","name":"jamesnulliu"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://jamesnulliu.github.io/blogs/wsl-is-all-you-need/"},"publisher":{"@type":"Organization","name":"ÁßãÊ∞¥¬∑JamesNULLiu","logo":{"@type":"ImageObject","url":"https://jamesnulliu.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jamesnulliu.github.io/ accesskey=h title="ÁßãÊ∞¥¬∑JamesNULLiu (Alt + H)">ÁßãÊ∞¥¬∑JamesNULLiu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://jamesnulliu.github.io/zh/ title=ÁÆÄ‰Ωì‰∏≠Êñá aria-label=ÁÆÄ‰Ωì‰∏≠Êñá>ÁÆÄ‰Ωì‰∏≠Êñá</a></li></ul></div></div><ul id=menu><li><a href=https://jamesnulliu.github.io/ title=Home><span>Home</span></a></li><li><a href=https://jamesnulliu.github.io/about_me/ title="About Me"><span>About Me</span></a></li><li><a href=https://jamesnulliu.github.io/blogs/ title=Blogs><span>Blogs</span></a></li><li><a href=https://jamesnulliu.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jamesnulliu.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://jamesnulliu.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://jamesnulliu.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://jamesnulliu.github.io/friends/ title=Friends><span>Friends</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jamesnulliu.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://jamesnulliu.github.io/blogs/>Blogs</a></div><h1 class="post-title entry-hint-parent">WSL is All You Need</h1><div class=post-description>How do I work with WSL</div><div class=post-meta><span title='2025-01-10 13:25:00 +0800 +0800'>Jan-10-2025</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;700 words&nbsp;¬∑&nbsp;jamesnulliu</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-motivation aria-label="1. Motivation">1. Motivation</a></li><li><a href=#2-installation aria-label="2. Installation">2. Installation</a></li><li><a href=#3-change-the-storage-location-of-a-distribution aria-label="3. Change the Storage Location of a Distribution">3. Change the Storage Location of a Distribution</a></li><li><a href=#4-work-with-vscode aria-label="4. Work with VSCode">4. Work with VSCode</a></li><li><a href=#5-install-docker-in-wsl aria-label="5. Install Docker in WSL">5. Install Docker in WSL</a></li><li><a href=#6-proxy aria-label="6. Proxy">6. Proxy</a></li><li><a href=#7-default-user aria-label="7. Default User">7. Default User</a></li><li><a href=#8-hostname aria-label="8. Hostname">8. Hostname</a></li><li><a href=#9-compress-the-wsl-file-system aria-label="9. Compress the WSL File System">9. Compress the WSL File System</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{let e=null;const t=window.innerHeight+window.pageYOffset>=document.body.offsetHeight-100;if(t)e=elements[elements.length-1];else{let t=null,n=1/0;elements.forEach(e=>{const s=getOffsetTop(e)-window.pageYOffset;if(s<=window.innerHeight*.3){const o=Math.abs(s);o<n&&(n=o,t=e)}}),e=t||elements[0]}if(e&&e!==activeElement){if(activeElement){const t=encodeURI(activeElement.getAttribute("id")).toLowerCase(),e=document.querySelector(`.inner ul li a[href="#${t}"]`);e&&e.classList.remove("active")}activeElement=e;const n=encodeURI(activeElement.getAttribute("id")).toLowerCase(),t=document.querySelector(`.inner ul li a[href="#${n}"]`);t&&(t.classList.add("active"),document.getElementById("toc-container").classList.contains("wide")&&scrollTocToActiveItem(t))}},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}function scrollTocToActiveItem(e){const t=document.querySelector(".toc .inner");if(!t||!e)return;const n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.height/2,i=s.top-n.top+t.scrollTop,a=i-o;t.scrollTo({top:Math.max(0,a),behavior:"smooth"})}</script><div class=post-content><h2 id=1-motivation>1. Motivation<a hidden class=anchor aria-hidden=true href=#1-motivation>#</a></h2><p>Coding on Windows feels like a nightmare, but most games do not run on Linux, and I hate MacOS ü§¢ü§Æ from many aspects.</p><p>After trying many ways, now I firmly believe that WSL (as a Docker launcher ü§£) is the best solution if:</p><ul><li>You are a programmer specifically relying on Unix environment, for example, Deep Learning, CUDA, C++, etc.</li><li>You are a gamer who wants to play games on Windows.</li><li>You want to switch between Linux and Windows with zero cost.</li></ul><blockquote><p>üí°<strong>NOTE</strong><br><strong>Windows Subsystem for Linux (WSL)</strong> is a feature of Windows that allows you to run a Linux environment on your Windows machine, without the need for a separate virtual machine or dual booting. WSL is designed to provide a seamless and productive experience for developers who want to use both Windows and Linux at the same time.</p></blockquote><h2 id=2-installation>2. Installation<a hidden class=anchor aria-hidden=true href=#2-installation>#</a></h2><blockquote><p>Official Doc: <a href=https://learn.microsoft.com/en-us/windows/wsl/install target=_blank rel="noopener noreferrer">How to install Linux on Windows with WSL</a></p></blockquote><blockquote><p>‚ö†Ô∏è<strong>WARNING</strong><br>If you are using scoop on Windows, make sure uninstall it before the first-time installation of a WSL distribution. You can reinstall scoop after the installation.</p></blockquote><p>List all available WSL distributions:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=p>-</span><span class=n>-list</span> <span class=p>-</span><span class=n>-online</span>
</span></span></code></pre></td></tr></table></div></div><p>Install a specific WSL distribution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=p>-</span><span class=n>-install</span> <span class=n>-d</span> <span class=p>&lt;</span><span class=nb>distro-name</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Run a WSL distribution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=n>-d</span> <span class=p>&lt;</span><span class=nb>distro-name</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=3-change-the-storage-location-of-a-distribution>3. Change the Storage Location of a Distribution<a hidden class=anchor aria-hidden=true href=#3-change-the-storage-location-of-a-distribution>#</a></h2><p>List installed WSL distributions:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=n>-l</span> <span class=n>-v</span>
</span></span></code></pre></td></tr></table></div></div><p>Shutdown WSL service:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=p>-</span><span class=n>-shutdown</span>
</span></span></code></pre></td></tr></table></div></div><p>Export a WSL distribution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=p>-</span><span class=n>-export</span> <span class=p>&lt;</span><span class=nb>distro-name</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nb>path-to</span><span class=n>-exported-tar</span><span class=p>&gt;.</span><span class=py>tar</span>
</span></span></code></pre></td></tr></table></div></div><p>Unregister the target WSL distribution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wslconfig</span> <span class=p>/</span><span class=n>u</span> <span class=p>&lt;</span><span class=nb>distro-name</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Import a WSL distribution from tar and specify the storage location; Note that you can specify any new distro name here:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=p>-</span><span class=n>-import</span> <span class=p>&lt;</span><span class=nb>new-distro</span><span class=n>-name</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nb>path-to</span><span class=n>-the-new-storage-dir</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nb>path-to</span><span class=n>-exported-tar</span><span class=p>&gt;.</span><span class=py>tar</span>
</span></span></code></pre></td></tr></table></div></div><p>After importing, the default user of <code>&lt;new-distro-name></code> would become <code>root</code>. You can set the default user for a WSL distribution by modifying the <code>/etc/wsl.conf</code> file. See <a href=#7-default-user>7. Default User
</a>.</p><h2 id=4-work-with-vscode>4. Work with VSCode<a hidden class=anchor aria-hidden=true href=#4-work-with-vscode>#</a></h2><p>Run a WSL distribution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=n>-d</span> <span class=p>&lt;</span><span class=nb>distro-name</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Open a directory in WSL with VSCode:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>code</span> <span class=p>&lt;</span><span class=nb>path-to</span><span class=n>-a-directory-in-wsl</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=5-install-docker-in-wsl>5. Install Docker in WSL<a hidden class=anchor aria-hidden=true href=#5-install-docker-in-wsl>#</a></h2><p><del>I don&rsquo;t like Docker Desktop for Windows</del>. Instead, you can install Docker in WSL as you do in a normal Linux system.</p><p>If you want to play with cuda and deep learning in your WSL, see this blog: <a href=/blogs/docker-container-with-nvidia-gpu-support target=_blank rel="noopener noreferrer">Docker Container with Nvidia GPU Support</a></p><p>If you need a concise mannual for docker images and containers, see this blog: <a href=/blogs/something-about-docker target=_blank rel="noopener noreferrer">Something about Docker</a></p><p>To open a directory inside a running container with VSCode, install extension <code>ms-vscode-remote.remote-containers</code>, and:</p><ol><li>Open a directory in a WSL (where you installed docker and ran containers) with VSCode following <a href=#4-work-with-vscode>4. Work with VSCode
</a>.</li><li>Press <code>ctrl</code> + <code>shift</code> + <code>p</code>, search for command &ldquo;Dev Containers: Attach to Running Container&mldr;&rdquo;.</li><li>Choose and click the container you want to open.</li><li>That&rsquo;s it.</li></ol><h2 id=6-proxy>6. Proxy<a hidden class=anchor aria-hidden=true href=#6-proxy>#</a></h2><p>Somethimes you may need to set the proxy for your subsystem.</p><p>From my experience, the easiest way is to turn on <code>System Proxy</code> and <code>TUN Mode</code> in clash or v2ray on windows, and your WSL and the running containers will automatically use the proxy.</p><h2 id=7-default-user>7. Default User<a hidden class=anchor aria-hidden=true href=#7-default-user>#</a></h2><p>You can set the default user for a WSL distribution by modifying the <code>/etc/wsl.conf</code> file.</p><p>First, login to a WSL distribution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=n>-d</span> <span class=p>&lt;</span><span class=nb>distro-name</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Then, create or modify the <code>/etc/wsl.conf</code> file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/wsl.conf
</span></span></code></pre></td></tr></table></div></div><p>Add the following lines to the file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[user]</span>
</span></span><span class=line><span class=cl><span class=na>default</span><span class=o>=</span><span class=s>&lt;your-username&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=8-hostname>8. Hostname<a hidden class=anchor aria-hidden=true href=#8-hostname>#</a></h2><p>You can set the hostname for a WSL distribution by modifying the <code>/etc/hostname</code> file.</p><p>First, login to a WSL distribution:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=n>-d</span> <span class=p>&lt;</span><span class=nb>distro-name</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Then, create or modify the <code>/etc/wsl.conf</code> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/wsl.conf
</span></span></code></pre></div><p>Add the following lines to the file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[network]</span>
</span></span><span class=line><span class=cl><span class=na>hostname</span> <span class=o>=</span> <span class=s>&lt;your-hostname&gt;</span>
</span></span></code></pre></div><h2 id=9-compress-the-wsl-file-system>9. Compress the WSL File System<a hidden class=anchor aria-hidden=true href=#9-compress-the-wsl-file-system>#</a></h2><blockquote><p>Virtual disk files will grow automatically as you add files, but they will not shrink automatically when you delete files. This can lead to a large virtual disk file that takes up a lot of space on your hard drive.</p></blockquote><p>First, search for a <code>.vdhx</code> file in your computer, which is the virtual disk file for your WSL distribution. The default location is &ldquo;C:/Users/&lt;your-username>/AppData/Local/wsl/&lt;hash-value>/ext4.vhdx&rdquo;.</p><p>Then, run the following command in PowerShell:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=p>-</span><span class=n>-shutdown</span>
</span></span></code></pre></td></tr></table></div></div><p>After that, run <code>diskpart</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>diskpart</span>
</span></span></code></pre></td></tr></table></div></div><p>In the pop-up window, run the following commands:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>select </span><span class=n>vdisk</span> <span class=n>file</span><span class=p>=</span><span class=s2>&#34;&lt;path-to-your-vhdx-file&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>compact</span> <span class=n>vdisk</span>
</span></span><span class=line><span class=cl><span class=n>detach</span> <span class=n>vdisk</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://jamesnulliu.github.io/tags/windows/>Windows</a></li><li><a href=https://jamesnulliu.github.io/tags/linux/>Linux</a></li><li><a href=https://jamesnulliu.github.io/tags/wsl/>Wsl</a></li><li><a href=https://jamesnulliu.github.io/tags/environment/>Environment</a></li></ul><nav class=paginav><a class=prev href=https://jamesnulliu.github.io/blogs/a-brief-talk-on-speculative-decoding/><span class=title>¬´ Prev</span><br><span>A Brief Talk on Speculative Decoding</span>
</a><a class=next href=https://jamesnulliu.github.io/blogs/create-a-libtorch-project/><span class=title>Next ¬ª</span><br><span>Create A LibTorch Project</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=jamesnulliu/jamesnulliu.github.io data-repo-id=R_kgDOMPCQIw data-category=Announcements data-category-id=DIC_kwDOMPCQI84Cgb2t data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></article></main><footer class=footer><span>¬© 2024-2025 JamesNULLiu</span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
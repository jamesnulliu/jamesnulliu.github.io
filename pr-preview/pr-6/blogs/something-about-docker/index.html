<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Something about Docker | 秋水·JamesNULLiu</title><meta name=keywords content="docker"><meta name=description content="Something about docker."><meta name=author content="jamesnulliu"><link rel=canonical href=https://jamesnulliu.github.io/blogs/something-about-docker/><link crossorigin=anonymous href=/assets/css/stylesheet.62cb9c488bb33c0e9a9d3c29b7f4259cbb0db25aaa19ba672188203d3d5bcaf9.css integrity="sha256-YsucSIuzPA6anTwpt/QlnLsNslqqGbpnIYggPT1byvk=" rel="preload stylesheet" as=style><link rel=icon href=https://jamesnulliu.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jamesnulliu.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jamesnulliu.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jamesnulliu.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jamesnulliu.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://jamesnulliu.github.io/blogs/something-about-docker/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]]}}</script><meta property="og:url" content="https://jamesnulliu.github.io/blogs/something-about-docker/"><meta property="og:site_name" content="秋水·JamesNULLiu"><meta property="og:title" content="Something about Docker"><meta property="og:description" content="Something about docker."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2024-08-08T12:00:00+08:00"><meta property="article:modified_time" content="2025-09-12T22:14:12+00:00"><meta property="article:tag" content="Docker"><meta name=twitter:card content="summary"><meta name=twitter:title content="Something about Docker"><meta name=twitter:description content="Something about docker."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://jamesnulliu.github.io/blogs/"},{"@type":"ListItem","position":2,"name":"Something about Docker","item":"https://jamesnulliu.github.io/blogs/something-about-docker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Something about Docker","name":"Something about Docker","description":"Something about docker.","keywords":["docker"],"articleBody":" Check this blog if you want a Docker Container with Nvidia GPU Support.\n1. About Image 1.1. Check Existing Images and Statistics 1 2 3 4 # List all images docker images # Check disk usage of docker (images, conatiners) docker system df To list all images not being used by any container, run:\n1 2 3 4 5 docker images --filter \"dangling=false\" -q | xargs -r docker inspect --format '{{ .Id }} {{ .RepoTags }}' | grep -v '' | while read id tags; do if ! docker ps -a --format '{{.Image}}' | grep -q \"$(echo $tags | cut -d'[' -f2 | cut -d']' -f1)\"; then echo \"$id $tags\" fi done 1.2. Rename an Image 1 docker tag : 1.3. Pull an Image Search for an image in Docker Hub.\nPull the image by running:\n1 docker pull : Or download the layers to by using this script:\n1 2 3 4 5 6 mkdir -p # Directory to store the layers bash download-frozen-image-v2.sh : # Load the image tar -cC . | docker load 1.4. Build an Image Use a Dockerfile to build a new image based on an existing image.\nCheck this example project: jamesnulliu/deeplearning-docker-build .\nThe following command in ./scripts/build.sh would build image ::\n1 2 3 4 docker build \\ -f Dockerfile \\ -t jamesnulliu/deeplearning:torch2.6-cuda12.6-ubuntu24.04 \\ . Note that . specifiles the build context, where docker can reference (e.g., COPY and ADD) the containing files during the build process. You can change it to other directory path according to your needs.\nYou will find the new image after building by runing docker images.\n1.5. Save an Image to a tar File To export an image to a tar file with reusable layer imformations, run the following command:\n1 2 3 docker save -o .tar : # Or docker save -o .tar See 1.6. Load an Image to load the generated tar file to an image.\n1.6. Load an Image Suppose you have a tar file .tar, if the file is generated by docker save (see 1.5. Save an Image to a tar File), load the image by running:\n1 docker load -i .tar Or if the file is generated by docker export (see 2.4 Export a container to a tar File), load the container to an image by running:\n1 docker import .tar : 1.7. Remove an Image Before removing an image, you need to:\nStop containers using the image: docker stop . Remove containers using the image: docker rm . Then remove the image:\n1 2 3 docker rmi : # Or docker rmi 2. About Container 2.1. Check Existing Containers and Statistics 1 2 3 4 5 6 # List running/[all] containers docker ps [-a] # Check statistics of all/[some] containers docker stats [] # Check disk usage of docker (images, conatiners) docker system df 2.2. Create a Container Basic Parameters:\nClick to expand -it: Interactive mode with pseudo-TTY terminal --name : Assign a name to the container for easier reference -p :: Map host port to container port (e.g. 8888:22) --entrypoint /bin/bash: Override default entrypoint with bash shell : Name of the Docker image to use (e.g. ubuntu, nvidia/cuda) : Version/tag of the image (e.g. latest, 20.04) Additional Options:\nClick to expand --shm-size G: Set size of /dev/shm (shared memory) in GB (e.g. 2G) --gpus all: [Optional] Give container access to all GPUs (requires nvidia-docker) -v :: Mount host directory into container -e KEY=VALUE: Set environment variables --network=host: Use host network stack; If set, -p is not needed, and you can access host services directly with localhost --ipc=host: Use host IPC namespace --privileged: Give extended privileges to container -u $(id -u):$(id -g): Run as current user instead of root --rm: Automatically remove container when it exits Example:\n1 2 3 4 5 6 7 8 9 # Create and run a container from : docker run -it \\ --gpus all \\ --name \\ -p : \\ --entrypoint /bin/bash \\ --shm-size G \\ : # Now you are in the container. To exit container and return to host, run exit, which will stop the containter; Or type Ctrl+P+Q, which will detach from container without stopping it.\n2.3. Start, Stop, Remove and Rename a Container Start a container:\n1 docker start Attach to a container:\n1 docker exec -it bash Stop a container:\n1 docker stop Remove a container:\n1 docker rm Rename a container:\n1 2 3 docker rename # or docker rename 2.4. Export a Container to a tar File Note that docker export only exports the container’s filesystem without layer information. It is more recommended to use docker save to save a image to a tar file (see 1.5. Save an Image to a tar File).\n1 docker export \u003e .tar See 1.6. Load an Image to load the generated tar file to an image.\n3. Change Docker Root Directory to a Different Location Check current docker root directory:\n1 docker info | grep \"Docker Root Dir\" Stop docker daemon:\n1 systemctl stop docker Edit (or create) the docker configuration file:\n1 vim /etc/docker/daemon.json Add or modify the configuration:\n1 2 3 { \"data-root\": \"\" } Copy the existing docker data to target location:\n1 rsync -aP Restart docker daemon:\n1 2 systemctl daemon-reload systemctl start docker Verify the new location:\n1 docker info | grep \"Docker Root Dir\" ","wordCount":"907","inLanguage":"en","datePublished":"2024-08-08T12:00:00+08:00","dateModified":"2025-09-12T22:14:12Z","author":[{"@type":"Person","name":"jamesnulliu"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://jamesnulliu.github.io/blogs/something-about-docker/"},"publisher":{"@type":"Organization","name":"秋水·JamesNULLiu","logo":{"@type":"ImageObject","url":"https://jamesnulliu.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jamesnulliu.github.io/ accesskey=h title="秋水·JamesNULLiu (Alt + H)">秋水·JamesNULLiu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://jamesnulliu.github.io/zh/ title=简体中文 aria-label=简体中文>简体中文</a></li></ul></div></div><ul id=menu><li><a href=https://jamesnulliu.github.io/ title=Home><span>Home</span></a></li><li><a href=https://jamesnulliu.github.io/about_me/ title="About Me"><span>About Me</span></a></li><li><a href=https://jamesnulliu.github.io/blogs/ title=Blogs><span>Blogs</span></a></li><li><a href=https://jamesnulliu.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jamesnulliu.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://jamesnulliu.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://jamesnulliu.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://jamesnulliu.github.io/friends/ title=Friends><span>Friends</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jamesnulliu.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://jamesnulliu.github.io/blogs/>Blogs</a></div><h1 class="post-title entry-hint-parent">Something about Docker</h1><div class=post-description>Something about docker.</div><div class=post-meta><span title='2024-08-08 12:00:00 +0800 +0800'>Aug-08-2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;907 words&nbsp;·&nbsp;jamesnulliu</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-about-image aria-label="1. About Image">1. About Image</a><ul><li><a href=#11-check-existing-images-and-statistics aria-label="1.1. Check Existing Images and Statistics">1.1. Check Existing Images and Statistics</a></li><li><a href=#12-rename-an-image aria-label="1.2. Rename an Image">1.2. Rename an Image</a></li><li><a href=#13-pull-an-image aria-label="1.3. Pull an Image">1.3. Pull an Image</a></li><li><a href=#14-build-an-image aria-label="1.4. Build an Image">1.4. Build an Image</a></li><li><a href=#15-save-an-image-to-a-tar-file aria-label="1.5. Save an Image to a tar File">1.5. Save an Image to a tar File</a></li><li><a href=#16-load-an-image aria-label="1.6. Load an Image">1.6. Load an Image</a></li><li><a href=#17-remove-an-image aria-label="1.7. Remove an Image">1.7. Remove an Image</a></li></ul></li><li><a href=#2-about-container aria-label="2. About Container">2. About Container</a><ul><li><a href=#21-check-existing-containers-and-statistics aria-label="2.1. Check Existing Containers and Statistics">2.1. Check Existing Containers and Statistics</a></li><li><a href=#22-create-a-container aria-label="2.2. Create a Container">2.2. Create a Container</a></li><li><a href=#23-start-stop-remove-and-rename-a-container aria-label="2.3. Start, Stop, Remove and Rename a Container">2.3. Start, Stop, Remove and Rename a Container</a></li><li><a href=#24-export-a-container-to-a-tar-file aria-label="2.4. Export a Container to a tar File">2.4. Export a Container to a tar File</a></li></ul></li><li><a href=#3-change-docker-root-directory-to-a-different-location aria-label="3. Change Docker Root Directory to a Different Location">3. Change Docker Root Directory to a Different Location</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{let e=null;const t=window.innerHeight+window.pageYOffset>=document.body.offsetHeight-100;if(t)e=elements[elements.length-1];else{let t=null,n=1/0;elements.forEach(e=>{const s=getOffsetTop(e)-window.pageYOffset;if(s<=window.innerHeight*.3){const o=Math.abs(s);o<n&&(n=o,t=e)}}),e=t||elements[0]}if(e&&e!==activeElement){if(activeElement){const t=encodeURI(activeElement.getAttribute("id")).toLowerCase(),e=document.querySelector(`.inner ul li a[href="#${t}"]`);e&&e.classList.remove("active")}activeElement=e;const n=encodeURI(activeElement.getAttribute("id")).toLowerCase(),t=document.querySelector(`.inner ul li a[href="#${n}"]`);t&&(t.classList.add("active"),document.getElementById("toc-container").classList.contains("wide")&&scrollTocToActiveItem(t))}},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}function scrollTocToActiveItem(e){const t=document.querySelector(".toc .inner");if(!t||!e)return;const n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.height/2,i=s.top-n.top+t.scrollTop,a=i-o;t.scrollTo({top:Math.max(0,a),behavior:"smooth"})}</script><div class=post-content><blockquote><p>Check this blog if you want a <a href=/blogs/docker-container-with-nvidia-gpu-support/>Docker Container with Nvidia GPU Support</a>.</p></blockquote><h2 id=1-about-image>1. About Image<a hidden class=anchor aria-hidden=true href=#1-about-image>#</a></h2><h3 id=11-check-existing-images-and-statistics>1.1. Check Existing Images and Statistics<a hidden class=anchor aria-hidden=true href=#11-check-existing-images-and-statistics>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># List all images</span>
</span></span><span class=line><span class=cl>docker images
</span></span><span class=line><span class=cl><span class=c1># Check disk usage of docker (images, conatiners)</span>
</span></span><span class=line><span class=cl>docker system df
</span></span></code></pre></td></tr></table></div></div><p>To list all images not being used by any container, run:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker images --filter <span class=s2>&#34;dangling=false&#34;</span> -q <span class=p>|</span> xargs -r docker inspect --format <span class=s1>&#39;{{ .Id }} {{ .RepoTags }}&#39;</span> <span class=p>|</span> grep -v <span class=s1>&#39;&lt;none&gt;&#39;</span> <span class=p>|</span> <span class=k>while</span> <span class=nb>read</span> id tags<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> ! docker ps -a --format <span class=s1>&#39;{{.Image}}&#39;</span> <span class=p>|</span> grep -q <span class=s2>&#34;</span><span class=k>$(</span><span class=nb>echo</span> <span class=nv>$tags</span> <span class=p>|</span> cut -d<span class=s1>&#39;[&#39;</span> -f2 <span class=p>|</span> cut -d<span class=s1>&#39;]&#39;</span> -f1<span class=k>)</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$id</span><span class=s2> </span><span class=nv>$tags</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=12-rename-an-image>1.2. Rename an Image<a hidden class=anchor aria-hidden=true href=#12-rename-an-image>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker tag &lt;image-id&gt; &lt;image-name&gt;:&lt;image-tag&gt;
</span></span></code></pre></td></tr></table></div></div><h3 id=13-pull-an-image>1.3. Pull an Image<a hidden class=anchor aria-hidden=true href=#13-pull-an-image>#</a></h3><p>Search for an image in <a href=https://hub.docker.com/>Docker Hub</a>.</p><p>Pull the image by running:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker pull &lt;image-name&gt;:&lt;image-tag&gt;
</span></span></code></pre></td></tr></table></div></div><p>Or download the layers to <code>&lt;dir-path></code> by using <a href=https://github.com/moby/moby/blob/master/contrib/download-frozen-image-v2.sh>this script</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir -p &lt;dir-path&gt;  <span class=c1># Directory to store the layers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash download-frozen-image-v2.sh &lt;dir-path&gt; &lt;image-name&gt;:&lt;image-tag&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load the image</span>
</span></span><span class=line><span class=cl>tar -cC &lt;dir-path&gt; . <span class=p>|</span> docker load
</span></span></code></pre></td></tr></table></div></div><h3 id=14-build-an-image>1.4. Build an Image<a hidden class=anchor aria-hidden=true href=#14-build-an-image>#</a></h3><p>Use a Dockerfile to build a new image based on an existing image.</p><p>Check this example project: <a href=https://github.com/jamesnulliu/deeplearning-docker-build/blob/main/Dockerfile target=_blank rel="noopener noreferrer">jamesnulliu/deeplearning-docker-build
</a>.</p><p>The following command in <a href=https://github.com/jamesnulliu/deeplearning-docker-build/blob/main/scripts/build.sh target=_blank rel="noopener noreferrer">./scripts/build.sh
</a>would build image <code>&lt;image-name>:&lt;image-tag></code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -f Dockerfile <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -t jamesnulliu/deeplearning:torch2.6-cuda12.6-ubuntu24.04 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    .
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Note that <code>.</code> specifiles the build context, where docker can reference (e.g., <code>COPY</code> and <code>ADD</code>) the containing files during the build process. You can change it to other directory path according to your needs.</p></blockquote><p>You will find the new image after building by runing <code>docker images</code>.</p><h3 id=15-save-an-image-to-a-tar-file>1.5. Save an Image to a tar File<a hidden class=anchor aria-hidden=true href=#15-save-an-image-to-a-tar-file>#</a></h3><p>To export an image to a tar file with reusable layer imformations, run the following command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker save -o &lt;some-name&gt;.tar &lt;image-name&gt;:&lt;image-tag&gt;
</span></span><span class=line><span class=cl><span class=c1># Or</span>
</span></span><span class=line><span class=cl>docker save -o &lt;some-name&gt;.tar &lt;image-id&gt;
</span></span></code></pre></td></tr></table></div></div><p>See <a href=/blogs/something-about-docker/#16-load-an-image>1.6. Load an Image</a> to load the generated tar file to an image.</p><h3 id=16-load-an-image>1.6. Load an Image<a hidden class=anchor aria-hidden=true href=#16-load-an-image>#</a></h3><p>Suppose you have a tar file <code>&lt;some-name>.tar</code>, if the file is generated by <code>docker save</code> (see <a href=/blogs/something-about-docker/#15-save-an-image-to-a-tar-file>1.5. Save an Image to a tar File</a>), load the image by running:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker load -i &lt;some-name&gt;.tar
</span></span></code></pre></td></tr></table></div></div><p>Or if the file is generated by <code>docker export</code> (see <a href=/blogs/something-about-docker/#24-export-a-container-to-a-tar-file>2.4 Export a container to a tar File</a>), load the container to an image by running:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker import &lt;some-name&gt;.tar &lt;image-name&gt;:&lt;image-tag&gt;
</span></span></code></pre></td></tr></table></div></div><h3 id=17-remove-an-image>1.7. Remove an Image<a hidden class=anchor aria-hidden=true href=#17-remove-an-image>#</a></h3><p>Before removing an image, you need to:</p><ul><li>Stop containers using the image: <code>docker stop &lt;container-id></code>.</li><li>Remove containers using the image: <code>docker rm &lt;container-id></code>.</li></ul><p>Then remove the image:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker rmi &lt;image-name&gt;:&lt;image-tag&gt;
</span></span><span class=line><span class=cl><span class=c1># Or</span>
</span></span><span class=line><span class=cl>docker rmi &lt;image-id&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=2-about-container>2. About Container<a hidden class=anchor aria-hidden=true href=#2-about-container>#</a></h2><h3 id=21-check-existing-containers-and-statistics>2.1. Check Existing Containers and Statistics<a hidden class=anchor aria-hidden=true href=#21-check-existing-containers-and-statistics>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># List running/[all] containers</span>
</span></span><span class=line><span class=cl>docker ps <span class=o>[</span>-a<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># Check statistics of all/[some] containers</span>
</span></span><span class=line><span class=cl>docker stats <span class=o>[</span>&lt;container-id&gt;<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># Check disk usage of docker (images, conatiners)</span>
</span></span><span class=line><span class=cl>docker system df
</span></span></code></pre></td></tr></table></div></div><h3 id=22-create-a-container>2.2. Create a Container<a hidden class=anchor aria-hidden=true href=#22-create-a-container>#</a></h3><p>Basic Parameters:</p><details class=custom-details><summary class=custom-summary>Click to expand</summary><div><ul><li><code>-it</code>: Interactive mode with pseudo-TTY terminal</li><li><code>--name &lt;container-name></code>: Assign a name to the container for easier reference</li><li><code>-p &lt;host-port>:&lt;container-port></code>: Map host port to container port (e.g. <code>8888:22</code>)</li><li><code>--entrypoint /bin/bash</code>: Override default entrypoint with bash shell</li><li><code>&lt;image-name></code>: Name of the Docker image to use (e.g. <code>ubuntu</code>, <code>nvidia/cuda</code>)</li><li><code>&lt;image-tag></code>: Version/tag of the image (e.g. <code>latest</code>, <code>20.04</code>)</li></ul></div></details><br><p>Additional Options:</p><details class=custom-details><summary class=custom-summary>Click to expand</summary><div><ul><li><code>--shm-size &lt;shm-size>G</code>: Set size of /dev/shm (shared memory) in GB (e.g. <code>2G</code>)</li><li><code>--gpus all</code>: [Optional] Give container access to all GPUs (requires nvidia-docker)</li><li><code>-v &lt;host-path>:&lt;container-path></code>: Mount host directory into container</li><li><code>-e KEY=VALUE</code>: Set environment variables</li><li><code>--network=host</code>: Use host network stack; If set, <code>-p</code> is not needed, and you can access host services directly with <code>localhost</code></li><li><code>--ipc=host</code>: Use host IPC namespace</li><li><code>--privileged</code>: Give extended privileges to container</li><li><code>-u $(id -u):$(id -g)</code>: Run as current user instead of root</li><li><code>--rm</code>: Automatically remove container when it exits</li></ul></div></details><br><p>Example:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Create and run a container from &lt;image-name&gt;:&lt;image-tag&gt;</span>
</span></span><span class=line><span class=cl>docker run -it <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --gpus all <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --name &lt;container-name&gt; <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -p &lt;host-port&gt;:&lt;container-port&gt; <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --entrypoint /bin/bash <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --shm-size &lt;shm-size&gt;G <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    &lt;image-name&gt;:&lt;image-tag&gt;
</span></span><span class=line><span class=cl><span class=c1># Now you are in the container.</span>
</span></span></code></pre></td></tr></table></div></div><p>To exit container and return to host, run <code>exit</code>, which will stop the containter; Or type <code>Ctrl+P+Q</code>, which will detach from container without stopping it.</p><h3 id=23-start-stop-remove-and-rename-a-container>2.3. Start, Stop, Remove and Rename a Container<a hidden class=anchor aria-hidden=true href=#23-start-stop-remove-and-rename-a-container>#</a></h3><p>Start a container:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker start &lt;container-name&gt;
</span></span></code></pre></td></tr></table></div></div><p>Attach to a container:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker <span class=nb>exec</span> -it &lt;container-name&gt; bash
</span></span></code></pre></td></tr></table></div></div><p>Stop a container:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker stop &lt;contianer-name&gt;
</span></span></code></pre></td></tr></table></div></div><p>Remove a container:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker rm &lt;container-name&gt;
</span></span></code></pre></td></tr></table></div></div><p>Rename a container:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker rename &lt;container-id&gt; &lt;new-name&gt;
</span></span><span class=line><span class=cl><span class=c1># or</span>
</span></span><span class=line><span class=cl>docker rename &lt;old-name&gt; &lt;new-name&gt;
</span></span></code></pre></td></tr></table></div></div><h3 id=24-export-a-container-to-a-tar-file>2.4. Export a Container to a tar File<a hidden class=anchor aria-hidden=true href=#24-export-a-container-to-a-tar-file>#</a></h3><p>Note that <code>docker export</code> only exports the container&rsquo;s filesystem without layer information. It is more recommended to use <code>docker save</code> to save a image to a tar file (see <a href=/blogs/something-about-docker/#15-save-an-image-to-a-tar-file>1.5. Save an Image to a tar File</a>).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker <span class=nb>export</span> &lt;container-id&gt; &gt; &lt;some-name&gt;.tar
</span></span></code></pre></td></tr></table></div></div><p>See <a href=/blogs/something-about-docker/#16-load-an-image>1.6. Load an Image</a> to load the generated tar file to an image.</p><h2 id=3-change-docker-root-directory-to-a-different-location>3. Change Docker Root Directory to a Different Location<a hidden class=anchor aria-hidden=true href=#3-change-docker-root-directory-to-a-different-location>#</a></h2><p>Check current docker root directory:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker info <span class=p>|</span> grep <span class=s2>&#34;Docker Root Dir&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Stop docker daemon:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl stop docker
</span></span></code></pre></td></tr></table></div></div><p>Edit (or create) the docker configuration file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim /etc/docker/daemon.json
</span></span></code></pre></td></tr></table></div></div><p>Add or modify the configuration:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;data-root&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;target-docker-root&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Copy the existing docker data to target location:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rsync -aP &lt;current-docker-root&gt; &lt;target-docker-root&gt;
</span></span></code></pre></td></tr></table></div></div><p>Restart docker daemon:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl daemon-reload
</span></span><span class=line><span class=cl>systemctl start docker
</span></span></code></pre></td></tr></table></div></div><p>Verify the new location:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker info <span class=p>|</span> grep <span class=s2>&#34;Docker Root Dir&#34;</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://jamesnulliu.github.io/tags/docker/>Docker</a></li></ul><nav class=paginav><a class=prev href=https://jamesnulliu.github.io/blogs/docker-container-with-nvidia-gpu-support/><span class=title>« Prev</span><br><span>Docker Container with Nvidia GPU Support</span>
</a><a class=next href=https://jamesnulliu.github.io/blogs/offline-installation-of-vscode-server-and-extensions/><span class=title>Next »</span><br><span>Offline Installation of vscode-server and Extensions</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=jamesnulliu/jamesnulliu.github.io data-repo-id=R_kgDOMPCQIw data-category=Announcements data-category-id=DIC_kwDOMPCQI84Cgb2t data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></article></main><footer class=footer><span>© 2024-2025 JamesNULLiu</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>